{"version":3,"sources":["../../src/controllers/auth.js"],"names":["login","req","res","username","body","password","undefined","json","error","message","returnData","length","token","jwt","sign","userID","id","expiresIn","register","gender","birthDay","birthday","returnCheckExist"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AACA;;;;;;AACO,IAAMA,wBAAQ,SAARA,KAAQ,CAACC,GAAD,EAAKC,GAAL,EAAa;;AAE9B,QAAIC,WAAWF,IAAIG,IAAJ,CAASD,QAAxB;AACA,QAAIE,WAAWJ,IAAIG,IAAJ,CAASC,QAAxB;AACA,QAAG,EAAEF,YAAYG,SAAZ,IAAyBD,YAAYC,SAAvC,CAAH,EACI,OAAOJ,IAAIK,IAAJ,CAAS;AACZC,eAAO,IADK;AAEZC,iBAAS;AAFG,KAAT,CAAP;AAIJ,4BAAG,kEAAH,EAAsE,CAAEN,QAAF,EAAY,kBAAIE,QAAJ,CAAZ,CAAtE,EAAkG,UAACK,UAAD,EAAgB;;AAE9G,YAAGA,WAAWC,MAAX,GAAoB,CAAvB,EAA0B;AACtB,gBAAMC,QAAQC,uBAAIC,IAAJ,CAAS,EAAEC,QAAQL,WAAW,CAAX,EAAcM,EAAxB,EAAT,EAAsC,cAAtC,EAAqD,EAAEC,WAAW,KAAb,EAArD,CAAd;AACAf,gBAAIK,IAAJ,CAAS;AACLC,uBAAO,KADF;AAELC,yBAAS,SAFJ;AAGLG,uBAAOA;AAHF,aAAT;AAKH,SAPD,MAOO;AACHV,gBAAIK,IAAJ,CAAS;AACLC,uBAAO,IADF;AAELC,yBAAS;AAFJ,aAAT;AAIH;AACJ,KAfD;AAgBH,CAzBM;;AA2BA,IAAMS,8BAAW,SAAXA,QAAW,CAACjB,GAAD,EAAKC,GAAL,EAAa;AACjC,QAAIC,WAAWF,IAAIG,IAAJ,CAASD,QAAxB;AACA,QAAIE,WAAWJ,IAAIG,IAAJ,CAASC,QAAxB;AACA,QAAIc,SAASlB,IAAIG,IAAJ,CAASe,MAAtB;AACA,QAAIC,WAAWnB,IAAIG,IAAJ,CAASiB,QAAxB;AACA,QAAG,EAAElB,YAAYG,SAAZ,IAAyBD,YAAYC,SAArC,IAAkDa,UAAUb,SAA5D,IAAyEc,YAAYd,SAAvF,CAAH,EACI,OAAOJ,IAAIK,IAAJ,CAAS;AACZC,eAAO,IADK;AAEZC,iBAAS;AAFG,KAAT,CAAP;AAIJ,4BAAG,gDAAH,EAAoD,CAAEN,QAAF,CAApD,EAAiE,UAACmB,gBAAD,EAAsB;AACnF,YAAGA,iBAAiBX,MAAjB,IAA2B,CAA9B,EAAiC;;AAE7B,oCAAG,8BAAH,EAAkC;AAC9BR,0BAAUA,QADoB;AAE9BE,0BAAU,kBAAIA,QAAJ,CAFoB;AAG9BgB,0BAAUD,QAHoB;AAI9BD,wBAAQA;AAJsB,aAAlC,EAKE,UAACX,KAAD,EAAOE,UAAP,EAAsB;AACpBR,oBAAIK,IAAJ,CAAS;AACLC,2BAAO,KADF;AAELC,6BAAS;AAFJ,iBAAT;AAIH,aAVD;AAWH,SAbD,MAaO;AACHP,gBAAIK,IAAJ,CAAS;AACLC,uBAAO,IADF;AAELC,yBAAS;AAFJ,aAAT;AAIH;AACJ,KApBD;AAqBH,CA/BM","file":"auth.js","sourcesContent":["import jwt from 'jsonwebtoken';\nimport db from '../utils/database';\nimport md5 from 'md5';\nexport const login = (req,res) => {\n\n    let username = req.body.username;\n    let password = req.body.password;\n    if(!(username != undefined && password != undefined))\n        return res.json({\n            error: true,\n            message: 'Invalid'\n        })\n    db('SELECT * FROM `userinfo` WHERE `username` = ? and `password` = ?',[ username, md5(password) ],(returnData) => {\n\n        if(returnData.length > 0) {\n            const token = jwt.sign({ userID: returnData[0].id },'SuperHeroLOL',{ expiresIn: '24h' });\n            res.json({\n                error: false,\n                message: 'success',\n                token: token\n            });\n        } else {\n            res.json({\n                error: true,\n                message: 'Error: Username Or Password Incorrect!'\n            });\n        }\n    });\n}\n\nexport const register = (req,res) => {\n    let username = req.body.username;\n    let password = req.body.password;\n    let gender = req.body.gender;\n    let birthDay = req.body.birthday;\n    if(!(username != undefined && password != undefined && gender != undefined && birthDay != undefined))\n        return res.json({\n            error: true,\n            message: 'Invalid'\n        })\n    db('SELECT * FROM `userinfo` WHERE `username` = ? ',[ username ],(returnCheckExist) => {\n        if(returnCheckExist.length == 0) {\n          \n            db(\"INSERT INTO `userinfo` SET ?\",{ \n                username: username, \n                password: md5(password),\n                birthday: birthDay,\n                gender: gender\n            },(error,returnData) => {\n                res.json({\n                    error: false,\n                    message: 'Register Success',\n                });\n            });\n        } else {\n            res.json({\n                error: true,\n                message: 'Error: Username Already Exist!'\n            });\n        }\n    });\n}"]}